# Excel 데이터 유효성 검사 및 조건부 서식 가이드

## 데이터 유효성 검사 설정
- 경로: 셀 선택 → 데이터 탭 → 데이터 유효성 검사
- 목록: 미리 정의된 항목 중 선택 (드롭다운 생성)
- 정수: 최소값~최대값 범위의 정수만 입력 허용 (예: 1~100)
- 소수: 소수점 포함 숫자 범위 제한
- 날짜: 시작 날짜~끝 날짜 범위 제한 (예: 2024-01-01 ~ 2024-12-31)
- 시간: 시작 시간~끝 시간 범위 제한
- 텍스트 길이: 입력 텍스트의 문자 수 제한 (예: 최대 20자)
- 사용자 지정: 수식이 TRUE를 반환하면 입력 허용
- 적용 대상: 기존 데이터에는 영향 없음, 새 입력부터 적용

## 드롭다운 목록 만들기
- 방법 1 (직접 입력): 유효성 검사 → 목록 → 원본에 `서울,부산,대구,인천` (쉼표 구분)
- 방법 2 (범위 참조): 원본에 `=$G$1:$G$5` — 별도 영역에 목록 데이터 관리
- 방법 3 (이름 범위): 수식 → 이름 정의 → "도시목록" 정의 후 원본에 `=도시목록`
- 방법 4 (테이블 참조): 목록을 테이블로 변환 → 원본에 `=INDIRECT("테이블명[열이름]")` — 항목 추가 시 자동 확장
- 드롭다운 화살표 표시: "셀 내 드롭다운 표시" 체크 확인
- 빈 값 무시: 체크 시 빈 셀 입력 허용
- 대소문자: 유효성 검사는 기본적으로 대소문자 구분 안 함

## 종속 드롭다운 (Dependent Dropdown)
- 1단계: 대분류 드롭다운 생성 (예: 시/도 선택)
- 2단계: 각 대분류에 해당하는 소분류 목록을 이름 범위로 정의
- 이름 정의 예: "서울"이라는 이름에 `강남구,강북구,종로구` 범위 지정
- 이름에 공백 불가: 이름에 공백이나 특수문자가 있으면 `SUBSTITUTE`로 치환
- 3단계: 소분류 드롭다운의 원본에 `=INDIRECT(A1)` — A1은 대분류 셀
- 예: A1에서 "서울" 선택 → B1 드롭다운에 서울의 구 목록 표시
- 3단계 종속: 같은 원리로 `=INDIRECT(B1)` 적용하여 3차 드롭다운 구현
- 주의: 대분류 변경 시 소분류 셀이 자동 초기화되지 않음 → VBA 또는 조건부 검증으로 보완

## 사용자 지정 수식 기반 유효성 검사
- 유효성 검사 → 허용: 사용자 지정 → 수식 입력 (TRUE면 허용, FALSE면 거부)
- 중복 입력 방지: `=COUNTIF($A:$A, A1)<=1` — 해당 열에 같은 값이 1개 이하일 때만 허용
- 텍스트만 허용: `=ISTEXT(A1)` — 숫자 입력 차단
- 숫자만 허용: `=ISNUMBER(A1)` — 텍스트 입력 차단
- 이메일 형식 검증: `=AND(ISERROR(FIND(" ",A1)), LEN(A1)-LEN(SUBSTITUTE(A1,"@",""))=1, FIND("@",A1)>1, FIND(".",A1,FIND("@",A1))>FIND("@",A1)+1)`
- 미래 날짜만: `=A1>TODAY()` — 오늘 이후 날짜만 입력 가능
- 시작일≤종료일: 종료일 셀에 `=B1>=A1` — 종료일이 시작일 이후여야 함
- 특정 문자로 시작: `=LEFT(A1,2)="AB"` — "AB"로 시작하는 코드만 허용

## 오류 메시지 및 입력 메시지 설정
- 입력 메시지: 유효성 검사 → 입력 메시지 탭 → 제목과 메시지 입력
- 셀 선택 시 말풍선 형태로 안내 메시지 표시 (예: "1~100 사이 정수를 입력하세요")
- 오류 알림: 유효성 검사 → 오류 알림 탭 → 스타일, 제목, 메시지 설정
- 오류 스타일 3가지:
  - 중지(Stop): 잘못된 입력 완전 차단 — 재시도/취소만 가능
  - 경고(Warning): 경고 표시 후 사용자가 계속 입력 가능 (예/아니오/취소)
  - 정보(Information): 정보 메시지만 표시, 입력은 허용 (확인/취소)
- 오류 메시지 예: 제목 "입력 오류", 메시지 "유효한 부서명을 선택해 주세요."

## 조건부 서식 기본 규칙
- 경로: 셀 선택 → 홈 탭 → 조건부 서식
- 셀 값 기준: 보다 큼, 보다 작음, 사이, 같음, 텍스트 포함, 날짜 발생
- 상위/하위 규칙: 상위 10개 항목, 상위 10%, 하위 10개, 하위 10%, 평균 초과/미만
- 중복 값: 조건부 서식 → 셀 강조 규칙 → 중복 값 → 중복 또는 고유 선택
- 서식 옵션: 글꼴 색, 셀 배경색, 테두리, 글꼴 스타일(굵게/기울임) 지정
- 사용자 지정 서식: "사용자 지정 형식" 선택 → 셀 서식 대화상자에서 상세 설정
- 적용 범위: 규칙 설정 시 "적용 대상" 확인 — 선택 범위와 다를 수 있음

## 색조, 데이터 막대, 아이콘 집합
- 색조(Color Scales): 값 크기에 따라 셀 배경색이 그라데이션으로 변화
  - 2색 스케일: 최소(녹색) → 최대(빨강) 등
  - 3색 스케일: 최소(빨강) → 중간(노랑) → 최대(녹색)
  - 기준: 최소/최대값, 백분위수, 수식 등으로 지정 가능
- 데이터 막대: 셀 내부에 수평 막대 표시, 값 크기에 비례
  - 단색 채우기 / 그라데이션 채우기 선택
  - 음수 값: 반대 방향 막대 또는 별도 색상
  - 축 위치: 자동/셀 중간/없음 설정
- 아이콘 집합: 값 범위에 따라 아이콘(화살표, 신호등, 깃발, 별 등) 표시
  - 3개/4개/5개 아이콘 집합 선택
  - 기준값 변경: 규칙 편집에서 각 아이콘의 임계값 수동 설정
  - 아이콘만 표시: "아이콘만 표시" 체크 → 셀 값 숨기고 아이콘만 보임

## 수식 기반 조건부 서식
- 새 규칙 → "수식을 사용하여 서식을 지정할 셀 결정" 선택
- 행 전체 강조: `=$C2>1000` — 열 참조를 절대($C), 행은 상대(2)로 지정 → C열이 1000 초과인 행 전체 서식
- 적용 대상을 `$A$2:$F$100`처럼 전체 범위로 설정해야 행 전체에 서식 적용
- 중복 값 강조: `=COUNTIF($A:$A, A1)>1` — 해당 열에서 2번 이상 등장하는 값 강조
- 행 번갈아 색상(줄무늬): `=MOD(ROW(),2)=0` — 짝수 행에 배경색 적용
- 빈 셀 강조: `=ISBLANK(A1)` — 입력 누락 셀 시각적 표시
- 오늘 날짜 강조: `=A1=TODAY()` — 오늘에 해당하는 셀 강조
- 두 열 비교: `=A1<>B1` — A열과 B열 값이 다른 행 강조
- AND/OR 조합: `=AND($B2="완료", $C2>100)` — 복합 조건

## 특정 텍스트 포함 시 서식
- 기본: 셀 강조 규칙 → 텍스트 포함 → 키워드 입력 (예: "긴급" 포함 시 빨간 배경)
- 수식: `=SEARCH("긴급", A1)>0` — 대소문자 무시 검색, FIND는 대소문자 구분
- 여러 키워드 중 하나: `=OR(ISNUMBER(SEARCH("긴급",A1)), ISNUMBER(SEARCH("중요",A1)))` — "긴급" 또는 "중요" 포함
- 정확히 일치: `=A1="완료"` — 부분 일치가 아닌 정확한 값 매칭
- 시작 문자: `=LEFT(A1,3)="PRJ"` — "PRJ"로 시작하는 셀
- 와일드카드: 수식 기반에서는 와일드카드 불가, SEARCH/FIND 함수 활용
- 적용 범위 주의: 텍스트 조건으로 행 전체를 강조하려면 열을 절대 참조

## 날짜 기반 조건부 서식
- 기본 규칙: 셀 강조 → 날짜 발생 → 어제/오늘/내일/지난 7일/이번 주/이번 달 등
- 기한 초과: `=AND(A1<TODAY(), A1<>"")` — 오늘 이전 날짜 강조 (빈 셀 제외)
- 기한 임박 (7일 이내): `=AND(A1-TODAY()<=7, A1-TODAY()>0)` — 7일 내 도래 날짜
- 기한 경과 일수별 색상: 여러 규칙 조합
  - 규칙1: `=A1<TODAY()-30` → 빨강 (30일 초과 경과)
  - 규칙2: `=A1<TODAY()-7` → 주황 (7일 초과 경과)
  - 규칙3: `=A1<TODAY()` → 노랑 (기한 경과)
- 주말 강조: `=OR(WEEKDAY(A1)=1, WEEKDAY(A1)=7)` — 일요일(1) 또는 토요일(7)
- 특정 월 강조: `=MONTH(A1)=12` — 12월에 해당하는 셀
- 상태와 날짜 결합: `=AND($B1<TODAY(), $C1<>"완료")` — 기한 초과이면서 미완료인 항목

## 조건부 서식 관리
- 규칙 관리자: 홈 → 조건부 서식 → 규칙 관리 → 현재 시트 또는 특정 범위의 모든 규칙 확인
- 우선순위: 목록 위쪽 규칙이 먼저 적용, 위/아래 화살표로 순서 변경
- 여러 규칙이 같은 셀에 적용되면 모든 서식이 중첩 (충돌 시 우선순위 높은 것이 적용)
- 중지 조건(Stop If True): 해당 규칙이 TRUE면 하위 규칙 평가 중단
- 활용: 첫 번째로 매칭되는 규칙만 적용하고 싶을 때 각 규칙에 "True이면 중지" 체크
- 규칙 삭제: 규칙 관리자에서 선택 후 삭제 또는 조건부 서식 → 규칙 지우기 → 선택 영역/시트 전체
- 규칙 복사: 서식이 적용된 셀 → 서식 복사(붙여넣기 옵션: 서식만) → 대상 셀에 붙여넣기
- 성능 주의: 조건부 서식이 수천 개 이상이면 파일 속도 저하, 불필요한 규칙 정리 권장
