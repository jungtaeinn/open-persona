# Excel 피벗 테이블 완전 가이드

## 피벗 테이블 생성
- 데이터 준비: 머리글 행 필수, 빈 행/열 없이, 각 열은 동일한 데이터 유형
- 삽입 방법: 데이터 범위 내 셀 클릭 → 삽입 탭 → 피벗 테이블 → 테이블/범위 확인 → 새 워크시트 또는 기존 워크시트 선택
- 추천 피벗 테이블: 삽입 → 추천 피벗 테이블 — Excel이 데이터 구조를 분석해 자동 제안
- 데이터 원본 주의: 테이블(Ctrl+T)로 변환 후 피벗 생성하면 데이터 추가 시 범위가 자동 확장
- 단축키: Alt+N+V (피벗 테이블 삽입 대화상자)

## 필드 영역 구성
- 행(Rows): 데이터를 행 방향으로 그룹화 (예: 부서명, 제품명)
- 열(Columns): 데이터를 열 방향으로 그룹화 (예: 월, 분기)
- 값(Values): 집계할 숫자 데이터 (예: 매출액, 수량)
- 필터(Filters): 전체 피벗 테이블에 적용할 필터 (예: 지역, 연도)
- 필드 배치: 피벗 테이블 필드 목록에서 드래그 또는 체크박스로 영역에 추가
- 같은 필드를 값 영역에 여러 번 추가 가능 (합계와 개수 동시에)
- 행 영역에 여러 필드 추가 시 중첩 그룹 생성 (예: 지역 > 부서)

## 값 필드 설정
- 기본 집계: 숫자는 합계, 텍스트는 개수가 기본값
- 변경 방법: 값 필드 클릭 → 값 필드 설정 → 원하는 집계 선택
- 합계(Sum): 값의 총합
- 개수(Count): 데이터 개수 (빈 셀 제외)
- 평균(Average): 산술 평균
- 최대(Max), 최소(Min): 범위 내 최대/최소값
- 곱(Product): 모든 값의 곱
- 표준편차(StdDev), 분산(Var): 통계 분석용
- 숫자 서식: 값 필드 설정 → 표시 형식 → 원하는 형식 (천단위, 소수점, 백분율 등)

## 값 표시 형식 변경
- 값 필드 설정 → "값 표시 형식" 탭에서 변경
- 기본 계산 없음: 원래 집계값 그대로 표시
- 총 합계의 %: 각 값이 전체 합계에서 차지하는 비율
- 열 합계의 %: 각 열 내에서의 비율
- 행 합계의 %: 각 행 내에서의 비율
- 다음 값과의 차이: 이전 항목 대비 증감 (전월 대비 매출 변화)
- 다음 값의 %: 이전 항목 대비 비율 (전월 대비 성장률)
- 누적 합계: 순서대로 누적 (월별 누적 매출)
- 순위(작은 순/큰 순): 값의 순위 표시
- 상위 항목의 %: 부모 항목 대비 비율

## 날짜 그룹화
- 날짜 필드 우클릭 → 그룹 → 년/분기/월/일/시/분/초 중 선택
- 여러 단위 동시 선택 가능: 년+월 선택 시 자동 계층 생성
- 월별 그룹: 날짜를 1월~12월로 자동 묶음
- 분기별 그룹: Q1(1~3월), Q2(4~6월), Q3(7~9월), Q4(10~12월)
- 주별 그룹: 일 단위 선택 후 "일 수"를 7로 설정
- 시작/끝 날짜 수동 설정으로 특정 기간만 분석 가능

## 숫자 범위 그룹화
- 숫자 필드를 행/열 영역에 배치 → 우클릭 → 그룹
- 시작 값, 끝 값, 간격 설정 (예: 0~100, 간격 10 → 0-10, 10-20, ...)
- 활용 예: 나이대별 고객 분포 (20대, 30대, ...), 가격대별 상품 수
- 텍스트 필드 수동 그룹: Ctrl로 여러 항목 선택 → 우클릭 → 그룹 → 사용자 지정 이름 부여

## 계산 필드
- 피벗 테이블 클릭 → 피벗 테이블 분석 탭 → 필드/항목/집합 → 계산 필드
- 이름 입력 후 수식에 기존 필드를 사용한 수식 작성
- 예: 이름 `이익률`, 수식 `=이익/매출` — 각 그룹의 이익을 매출로 나눈 비율
- 예: 이름 `단가`, 수식 `=매출/수량`
- 주의: 계산 필드는 항상 합계 기준으로 계산됨 (행별 계산이 아닌 합산 후 계산)
- 평균이 필요한 경우: 가중 평균이 되도록 SUMPRODUCT 방식 고려
- 삭제: 같은 메뉴에서 해당 필드 선택 → 삭제

## 피벗 차트
- 피벗 테이블 선택 → 피벗 테이블 분석 탭 → 피벗 차트 또는 삽입 탭 → 차트
- 피벗 테이블 필터/행/열 변경 시 차트가 자동 업데이트
- 차트에서 직접 필터 버튼으로 데이터 필터링 가능
- 지원 차트: 막대, 꺾은선, 원형, 영역, 분산형 등 대부분 유형
- 차트 필터 버튼 숨기기: 차트 클릭 → 분석 탭 → 필드 버튼 → 모두 숨기기
- 피벗 차트 삭제해도 피벗 테이블은 유지됨

## 슬라이서
- 삽입 방법: 피벗 테이블 클릭 → 피벗 테이블 분석 → 슬라이서 삽입 → 필드 선택
- 사용: 슬라이서 버튼 클릭으로 시각적 필터링, Ctrl+클릭으로 다중 선택
- 여러 피벗에 연결: 슬라이서 우클릭 → 보고서 연결 → 연결할 피벗 테이블 체크
- 서식: 슬라이서 탭에서 스타일, 열 수, 크기 변경 가능
- 대시보드 구성: 여러 슬라이서를 배치하여 대화형 대시보드 구현
- 일반 표(테이블)에도 슬라이서 삽입 가능 (Excel 2013+)

## 타임라인
- 삽입: 피벗 테이블 클릭 → 분석 탭 → 타임라인 삽입 → 날짜 필드 선택
- 날짜 필드가 있는 경우에만 사용 가능
- 기간 단위 전환: 년/분기/월/일 버튼으로 표시 단위 변경
- 범위 선택: 드래그로 연속 기간 선택 (예: 2024년 1월~6월)
- 슬라이서와 동일하게 여러 피벗 테이블에 동시 연결 가능
- 필터 해제: 타임라인의 X 버튼 클릭

## 피벗 테이블 새로고침 및 데이터 소스 변경
- 수동 새로고침: 피벗 테이블 우클릭 → 새로고침, 또는 분석 탭 → 새로고침
- 모두 새로고침: 데이터 탭 → 모두 새로고침 (Ctrl+Alt+F5) — 통합 문서의 모든 피벗 갱신
- 파일 열 때 자동 새로고침: 피벗 테이블 옵션 → 데이터 탭 → "파일을 열 때 데이터 새로 고침" 체크
- 데이터 소스 변경: 분석 탭 → 데이터 원본 변경 → 새 범위 또는 외부 연결 지정
- 원본을 테이블로 관리하면 행 추가 시 새로고침만으로 반영

## GETPIVOTDATA 함수
- 구문: `=GETPIVOTDATA(데이터필드, 피벗테이블, [필드1, 항목1, ...])`
- 예: `=GETPIVOTDATA("매출", $A$3, "부서", "영업", "월", "1월")` — 영업부 1월 매출 추출
- 자동 생성: 피벗 테이블 셀을 수식에서 참조하면 자동으로 GETPIVOTDATA 생성
- 비활성화: 분석 탭 → 옵션 → "GetPivotData 생성" 체크 해제 → 일반 셀 참조 사용
- 장점: 피벗 레이아웃이 변경되어도 올바른 값 참조 유지
- 동적 참조: 필드/항목 인수에 셀 참조 사용 가능 — `=GETPIVOTDATA("매출", $A$3, "부서", G1)`

## Power Pivot 소개
- Power Pivot: Excel 내장 데이터 모델링 도구 (대용량 데이터 처리, 여러 테이블 관계 설정)
- 활성화: 파일 → 옵션 → 추가 기능 → COM 추가 기능 → Microsoft Power Pivot for Excel 체크
- 데이터 모델: 여러 테이블 간 관계(조인) 설정 → 하나의 피벗 테이블에서 여러 테이블 필드 사용
- 관계 설정: Power Pivot → 다이어그램 보기 → 필드 드래그로 관계 생성
- DAX 기초 측정값: `총매출:=SUM(매출[금액])`, `평균단가:=AVERAGE(주문[단가])`
- DAX CALCULATE: `영업매출:=CALCULATE(SUM(매출[금액]), 부서[이름]="영업")` — 필터 컨텍스트 변경
- DAX 시간 인텔리전스: `전년매출:=CALCULATE(SUM(매출[금액]), SAMEPERIODLASTYEAR(날짜[Date]))` — 전년 동기 대비
- 장점: 수백만 행 처리, 메모리 내 압축 저장, 복잡한 비즈니스 로직을 DAX로 구현
